<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="完整 n8n Google API Credential 設定指南。手把手教你解決 Google Sheets/Gmail 串接時的 OAuth 2.0 認證問題，包含 Client ID 申請、憑證過期解決方案與未驗證警告排除。">
    <title>n8n Google API Credential 教學 | 解決 OAuth 2.0 認證與 7 天過期問題</title>
    <style>
        :root {
            --primary-color: #ff6b6b;
            /* n8n 風格紅 */
            --secondary-color: #2d3e50;
            /* 沉穩深藍 */
            --bg-color: #f8f9fa;
            --text-color: #333;
            --code-bg: #e9ecef;
            --border-color: #ddd;
        }

        body {
            font-family: "Noto Sans TC", "Microsoft JhengHei", -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.8;
            color: var(--text-color);
            background-color: var(--bg-color);
            margin: 0;
            padding: 0;
        }

        header {
            background-color: #fff;
            border-bottom: 1px solid var(--border-color);
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        h1 {
            color: var(--secondary-color);
            margin: 0;
            font-size: 2rem;
        }

        .subtitle {
            color: #666;
            font-weight: normal;
            margin-top: 0.5rem;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            background-color: #fff;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
            margin-top: 2rem;
            margin-bottom: 2rem;
            border-radius: 8px;
        }

        h2 {
            color: var(--secondary-color);
            border-left: 5px solid var(--primary-color);
            padding-left: 1rem;
            margin-top: 2.5rem;
            margin-bottom: 1.5rem;
        }

        h3 {
            color: #555;
            margin-top: 1.5rem;
        }

        p {
            margin-bottom: 1rem;
        }

        .highlight-box {
            background-color: #e3f2fd;
            border-left: 5px solid #2196f3;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .warning-box {
            background-color: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        code {
            background-color: var(--code-bg);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: Consolas, Monaco, monospace;
            color: #d63384;
        }

        ol,
        ul {
            margin-bottom: 1.5rem;
            padding-left: 1.5rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        .step-img {
            width: 100%;
            height: auto;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            margin: 1.5rem 0;
            display: block;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .img-caption {
            text-align: center;
            font-size: 0.9rem;
            color: #777;
            margin-top: -1rem;
            margin-bottom: 2rem;
        }

        footer {
            text-align: center;
            padding: 2rem;
            color: #777;
            font-size: 0.9rem;
            border-top: 1px solid var(--border-color);
        }

        .btn-link {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: 0.5rem 1rem;
            text-decoration: none;
            border-radius: 4px;
            font-weight: bold;
        }

        .btn-link:hover {
            opacity: 0.9;
        }
    </style>
</head>

<body>

    <header>
        <div class="container" style="box-shadow: none; margin: 0 auto; padding: 0;">
            <div style="text-align: left; margin-bottom: 1rem;">
                <a href="../tutorials.html" class="btn-link" style="background: none; color: #666; padding-left: 0;">←
                    回到教學列表</a>
            </div>
            <h1>n8n Google API Credential 整合指南：OAuth 2.0 憑證設定教學</h1>
            <div class="subtitle">從申請 API 到完成 OAuth 2.0 憑證設定的完整圖文教學</div>
        </div>
    </header>

    <main class="container">

        <section>
            <p>歡迎使用 n8n 自動化工具。本指南綜合了專家建議與實作經驗，將帶領您一步步完成 Google 服務（Gmail, Sheets, Drive
                等）的串接設定。即使您沒有程式背景，只要照著步驟操作，也能輕鬆完成。</p>

            <div class="highlight-box">
                <strong>核心概念：為什麼需要憑證？</strong><br>
                您可以將 <strong>Google Cloud</strong> 想像成一個巨大的「健身房」，裡面有各種器材（Gmail, Sheets）。<strong>憑證
                    (Credentials)</strong> 就像是您的「會員卡」。為了讓您的私人教練（n8n）能幫您使用器材，您必須先去櫃檯（Google Console）辦一張會員卡，並授權給教練使用。
            </div>
        </section>

        <section>
            <h2>第一階段：建立 Google Cloud 專案</h2>
            <p>首先，我們需要在 <strong>Google Cloud Platform (簡稱 GCP)</strong> 建立一個專屬的專案空間。<br>
                <em>（白話文：GCP 就是 Google 提供的「雲端後台管理介面」，專門給開發者或進階使用者管理 API 與服務的地方。）</em>
            </p>
            <ol>
                <li>前往 <a href="https://console.cloud.google.com/" target="_blank">Google Cloud Console</a> 控制台。</li>
                <li>點選左上角的專案選擇器，然後點擊<strong>「新增專案 (New Project)」</strong>。
                    <img src="../images/n8n-google-credential/google-cloud-console-new-project.jpg"
                        alt="Google Cloud Console 新增專案教學畫面" class="step-img">
                </li>
                <li>在專案名稱輸入 <code>n8n-automation</code> 或您喜歡的名稱。
                    <img src="../images/n8n-google-credential/google-cloud-console-new-project-2.jpg" alt="輸入專案名稱"
                        class="step-img">
                </li>
                <li>點擊「建立」，稍待片刻系統完成建置。</li>
            </ol>
        </section>

        <section>
            <h2>第二階段：啟用 Google API 服務</h2>
            <p>Google 預設關閉所有功能，我們需要手動開啟 n8n 會用到的服務器材。</p>
            <ol>
                <li>確認已選取剛剛建立的專案。</li>
                <li>點擊左側選單的<strong>「API 和服務」</strong> > <strong>「啟用 API 和服務」</strong>。
                    <img src="../images/n8n-google-credential/google-cloud-enable-api.jpg" alt="啟用 API 和服務選單"
                        class="step-img">
                </li>
                <li>點擊上方的<strong>「+ 啟用 API 和服務」</strong>按鈕進入程式庫。
                    <img src="../images/n8n-google-credential/google-cloud-enable-api-2.jpg" alt="進入 API 程式庫"
                        class="step-img">
                </li>
                <li>搜尋並逐一啟用以下 Google API 服務（Gmail, Sheets, Drive, Docs, Calendar）：
                    <img src="../images/n8n-google-credential/google-cloud-enable-api-3.jpg" alt="搜尋並啟用 API"
                        class="step-img">
                </li>
            </ol>
        </section>

        <section>
            <h2>第三階段：設定 OAuth 同意畫面 (OAuth Consent Screen)</h2>
            <p>這是設定當 n8n 請求 <strong>Google API Credential</strong> 權限時，Google 彈出的 OAuth 驗證視窗內容。</p>
            <ol>
                <li>在左側選單點選<strong>「API 和服務」</strong> > <strong>「OAuth 同意畫面」</strong>。
                    <img src="../images/n8n-google-credential/google-cloud-oauth-consent-screen.jpg" alt="選擇外部使用者類型"
                        class="step-img">
                </li>
                <li>點擊下方的<strong>「開始」</strong>按鈕。
                    <img src="../images/n8n-google-credential/google-cloud-oauth-consent-screen-2.jpg" alt="填寫應用程式資訊"
                        class="step-img">
                </li>
                <li>在<strong>「應用程式資訊」</strong>填入您的應用程式名稱、 Email。點擊「下一步」。
                    <img src="../images/n8n-google-credential/google-cloud-oauth-consent-screen-3.jpg" alt="填寫聯絡資訊"
                        class="step-img">
                </li>
                <li><strong>目標對象：</strong>點選「外部」。點擊「下一步」，再點擊「建立」。
                    <img src="../images/n8n-google-credential/google-cloud-oauth-consent-screen-4.jpg" alt="範圍設定直接儲存"
                        class="step-img">
                </li>
                <li>左邊會自動跳到<strong>總覽</strong>，點選「建立 OAuth 用戶端」。
                    <img src="../images/n8n-google-credential/google-cloud-oauth-consent-screen-5.jpg" alt="範圍設定直接儲存"
                        class="step-img">
                </li>
                <li><strong>建立 OAuth 用戶端 ID：</strong>點擊<strong>「網頁應用程式」</strong>。
                    <img src="../images/n8n-google-credential/google-cloud-oauth-consent-screen-6.jpg" alt="點擊新增測試使用者"
                        class="step-img">
                </li>
                <li>應用程式類型會自動帶入剛剛所選，現在請輸入 "名稱" 如 "n8n-automation"。接著需要輸入 "已授權的重新導向 URI"，我們在此暫停一下。
                    <img src="../images/n8n-google-credential/google-cloud-oauth-consent-screen-7.jpg"
                        alt="輸入測試使用者 Email" class="step-img">
                </li>
            </ol>
        </section>

        <section>
            <h2>第四階段：建立 n8n Google API Credentials (憑證)</h2>
            <p>
            <h3>這是最關鍵的技術步驟，我們需要取得 n8n 的回傳網址 (OAuth Redirect URL)、Client ID 與 Client Secret。</h3>
            <p>
            <ol>
                <li>回到 n8n 介面，新增一個 Google 節點（如 Google Gmail）。</li>
                <li>點開節點後，再點擊鉛筆圖示，開啟憑證選單。。
                    <img src="../images/n8n-google-credential/google-cloud-create-oauth-client-id.jpg" alt="開啟憑證選單"
                        class="step-img">
                </li>
                <li>點擊 <strong>Click To Copy</strong>，複製畫面上的<strong>OAuth Redirect URL</strong>。
                    <img src="../images/n8n-google-credential/google-cloud-create-oauth-client-id-2.jpg"
                        alt="貼上 Redirect URI" class="step-img">
                </li>
                <li>再度回到 Google Cloud Console 剛剛的畫面，在<strong>已授權的重新導向 URI</strong>格子中，貼上剛剛從 n8n 複製的<strong>OAuth
                        Redirect URL</strong>，然後點選<strong>建立</strong>。
                    <img src="../images/n8n-google-credential/google-cloud-create-oauth-client-id-3.jpg"
                        alt="貼上 Redirect URI" class="step-img">
                </li>
            </ol>
            <div class="warning-box">
                <strong>常見錯誤提醒：</strong><br>
                貼上的網址結尾<strong>不可以有斜線 /</strong>，且必須與 n8n 上顯示的完全一致（包含 https）。
            </div>
            <em>（白話文：這就像告訴 Google：「當權限核發完畢後，請把這張『通行證』寄送到這個 n8n 指定的地址。」）</em>
            </p>



            <h3>2. 獲取金鑰</h3>
            <p>畫面會顯示 <strong>Client ID (用戶端編號)</strong> 和 <strong>Client Secret (用戶端密鑰)</strong>。請將這兩串代碼複製並保存下來。<br>
                <em>（白話文：Client ID 是「帳號」，Client Secret 是「密碼」。這組帳密是專門給 n8n 這位機器人管家使用的，請妥善保管。）</em>
            </p>
            <!-- 圖片佔位：建立 OAuth 客戶端 ID 與複製金鑰 -->
            <img src="../images/n8n-google-credential/google-cloud-create-oauth-client-id-4.jpg"
                alt="Google API Credential 建立成功畫面：複製 Client ID 用戶端編號與 Client Secret 用戶端密鑰" class="step-img">
            <div class="img-caption">圖五：複製 Client ID 與 Client Secret 並妥善保存</div>
        </section>

        <section>
            <h2>第五階段：完成 n8n 連線</h2>
            <ol>
                <li>回到 n8n 的憑證設定視窗。</li>
                <li>將 <strong>Client ID</strong> 與 <strong>Client Secret</strong> 貼入對應欄位，並點擊右上角的橘色 <strong>Save</strong>
                    按鈕。</li>
                <li>點下方的 <strong>Sign in with Google</strong> 按鈕。</li>
                <img src="../images/n8n-google-credential/n8n-google-credential-1.jpg"
                    alt="點擊「進階」然後選擇「前往 n8n (不安全)」以完成授權" class="step-img" style="margin-top: 1rem;">
                <div class="img-caption">圖六：點擊「進階」然後選擇「前往 n8n (不安全)」以完成授權</div>
                <li>選擇您在「測試使用者」步驟中設定的 Google 帳號。</li>
                <img src="../images/n8n-google-credential/n8n-google-credential-2.jpg"
                    alt="點擊「進階」然後選擇「前往 n8n (不安全)」以完成授權" class="step-img" style="margin-top: 1rem;">
                <div class="img-caption">圖七：點擊「進階」然後選擇「前往 n8n (不安全)」以完成授權</div>
                <li><strong>處理安全警告：</strong>Google 會跳出「未經 Google 驗證」的警告視窗。這是正常現象，因為這是您私人的專案。<br>
                    請依照下圖指示，點擊<strong>「繼續」</strong>即可。
                    <img src="../images/n8n-google-credential/n8n-google-credential-3.jpg" alt="點擊「繼續」" class="step-img"
                        style="margin-top: 1rem;">
                    <div class="img-caption">圖八：點擊「繼續」</div>
                <li>點擊 <strong>全選</strong>，然後拉到畫面最下面，點擊<strong>「繼續」</strong>。</li>
                <img src="../images/n8n-google-credential/n8n-google-credential-4.jpg" alt="點擊「全選」" class="step-img"
                    style="margin-top: 1rem;">
                <div class="img-caption">圖九：點擊「全選」</div>
                <img src="../images/n8n-google-credential/n8n-google-credential-5.jpg" alt="點擊「繼續」" class="step-img"
                    style="margin-top: 1rem;">
                <div class="img-caption">圖十：點擊「繼續」</div>
                </li>
                <li>顯示 <strong>Connection Tested Successfully</strong>。</li>
                <img src="../images/n8n-google-credential/n8n-google-credential-6.jpg"
                    alt="Google Connection Tested Successfully" class="step-img" style="margin-top: 1rem;">
                <div class="img-caption">圖十一：顯示「Connection Tested Successfully」</div>
                <li>關掉小視窗，回到 n8n 的 Gmail Credential 畫面，顯示綠色的 <strong>Account Connected</strong>。</li>
                <img src="../images/n8n-google-credential/n8n-google-credential-7.jpg" alt="Google Account Connected"
                    class="step-img" style="margin-top: 1rem;">
                <div class="img-caption">圖十二：關掉小視窗，回到 n8n 的「Account Connected」</div>
            </ol>
        </section>

        <section>
            <h2>重要：解決「7 天過期」問題</h2>
            <div class="warning-box" style="margin-top: 0;">
                <strong>⚠️ 必讀提醒：</strong>如果您不做這一步，您的憑證每 7 天就會失效，需要重新手動連線！
            </div>
            <p>Google 為了安全，規定處於<strong>「測試 (Testing)」</strong>狀態的應用程式，其授權憑證 (Refresh Token) <strong>只有 7
                    天有效期</strong>。這意味著每週您都需要手動重新連線，非常不便。</p>
            <p>若希望長期穩定運行，請將應用程式切換為<strong>「正式版 (In production)」</strong>。</p>

            <div class="highlight-box">
                <strong>核心觀念：測試版 vs 正式版</strong>
                <ul>
                    <li><strong>測試版 (Testing)</strong>：無需審核，但憑證 7 天過期。適合短期測試。</li>
                    <li><strong>正式版 (In production)</strong>：憑證長期有效。但若服務對象是陌生大眾，需通過 Google 嚴格驗證。</li>
                </ul>
            </div>

            <h3>操作步驟：</h3>
            <ol>
                <li>回到 Google Cloud Console 的<strong>「OAuth 同意畫面」</strong>。</li>
                <li>點擊<strong>「發布應用程式 (PUBLISH APP)」</strong>按鈕。</li>
                <li>確認將狀態切換為<strong>「正式版 (In production)」</strong>。</li>
            </ol>

            <div class="warning-box">
                <strong>⚠️ 關於「Google 未驗證此應用程式」警告</strong><br>
                <p>切換到正式版後，因為我們是「個人自用」且沒有提交 Google 的繁瑣驗證流程，登入時會出現<strong>紅色驚嘆號</strong>或<strong>「未經 Google
                        驗證」</strong>的警告畫面。</p>
                <p><strong>這是完全正常的！</strong>因為這是您自己架設給自己用的服務。請直接點擊：<br>
                    <strong>「進階 (Advanced)」</strong> &gt; <strong>「前往 n8n (不安全)」</strong> 即可完成連線。
                </p>
            </div>
        </section>

        <section>
            <h2>常見疑難排解</h2>
            <ul>
                <li><strong>錯誤代碼 <code>redirect_uri_mismatch</code>：</strong>檢查 Google Cloud 中的 Redirect URI 是否與 n8n
                    提供的完全一致，特別注意結尾斜線。</li>
                <li><strong>設定後無法連線：</strong>Google 設定生效有時需要 5 分鐘到數小時，請稍等片刻再試。</li>
            </ul>
        </section>

    </main>

    <footer>
        <p>本指南綜合整理自 Alex Hsieh、雷蒙三十及新義豊株式会社之教學內容。</p>
        <p>
            <a href="../tutorials.html" style="color: var(--primary-color); margin-right: 1rem;">← 回到教學列表</a>
            <a href="https://luke.ninja" style="color: var(--primary-color);" target="_blank">Luke.ninja 主站</a>
        </p>
        <p>&copy; 2025 Luke Hou | n8n 自動化學習資源</p>
    </footer>

</body>

</html>