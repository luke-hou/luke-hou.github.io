<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>n8n 教學 (九)：改造 Chat 工作流，實現本地知識庫問答</title>
    <meta name="description" content="n8n 教學系列最終篇！本章將指導您如何改造聊天機器人工作流，整合 Qdrant 在地向量資料庫，讓您的 AI 助理能夠根據私有的本地知識庫進行精準問答，完成整個 RAG 應用的最後一哩路。">
    <meta name="keywords" content="n8n教學, Qdrant, Chatbot, RAG, 工作流改造, 聊天機器人, 本地知識庫, AI應用, 私有化">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="../css/style.css">
    <style>
        .tutorial-content img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 1.5rem auto;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .tutorial-content figure {
            margin: 1.5rem 0;
            text-align: center;
        }
        .tutorial-content figure img {
            margin: 0 auto;
        }
        .step {
            margin-bottom: 2.5rem;
            padding: 2rem;
            border: 1px solid #dee2e6;
            border-radius: .5rem;
            background-color: #f8f9fa;
            transition: box-shadow 0.3s ease-in-out;
        }
        .step:hover {
            box-shadow: 0 .5rem 1rem rgba(0,0,0,.15);
        }
        .step h3 {
            font-size: 1.75rem;
            color: #0d6efd;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }
        .step h3 .step-icon {
            margin-right: 1rem;
            font-size: 1.5rem;
        }
        .tutorial-intro, .tutorial-summary {
            background-color: #e9f7ff;
            border-left: 5px solid #0d6efd;
            padding: 1.5rem;
            margin: 2rem 0;
        }
    </style>
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container">
                <a class="navbar-brand" href="https://www.luke.ninja">Luke Hou 侯俊嘉個人網站</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item"><a class="nav-link" href="../index.html">首頁</a></li>
                        <li class="nav-item"><a class="nav-link" href="../n8n-tutorials.html">n8n 教學</a></li>
                        <li class="nav-item"><a class="nav-link" href="../resume.html">簡歷</a></li>
                        <li class="nav-item"><a class="nav-link" href="../portfolio.html">作品集</a></li>
                        <li class="nav-item"><a class="nav-link" href="../blog.html">分享</a></li>
                        <li class="nav-item"><a class="nav-link" href="../contact.html">聯絡我</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mt-5">
        <div class="row">
            <div class="col-lg-10 mx-auto">
                <article class="blog-post">
                    <h1 class="mb-3 display-5 border-bottom pb-3">n8n 教學 (九)：改造 Chat 工作流，實現本地知識庫問答</h1>
                    <p class="text-muted mb-4">發布日期：2025年8月</p>

                    <div class="tutorial-intro">
                        <h4>前言：最後一哩路，讓 AI 開口說「你的」話</h4>
                        <p>恭喜您來到本系列教學的最終章！我們已經成功將知識庫儲存在本地的 Qdrant 資料庫中。現在，我們將完成最後一塊拼圖：改造聊天工作流，讓 AI 能夠從這個私有知識庫中檢索資訊，並根據這些資訊來回答您的問題。本章將引導您<a href="#qdrant-settings">設定 Qdrant 檢索節點</a>，結束後，您將擁有一個完全在您掌控之下的、具備私有知識庫的問答機器人。</p>
                    </div>

                    <div class="tutorial-content">
                        <section class="step-by-step">
                            <div class="step">
                                <h3><i class="fas fa-exchange-alt step-icon"></i>步驟一：置換向量資料庫節點</h3>
                                <p>我們的起點是先前建立的聊天工作流。首先，我們需要將雲端的 Supabase 節點替換為本地的 Qdrant 節點。</p>
                                <ol>
                                    <li>打開您用於聊天的 n8n 工作流。</li>
                                    <li>選取並刪除 "Supabase Vector Store" 節點。</li>
                                    <li>在右下角的 "Tools" 面板中，點擊加號，搜尋並加入 "Qdrant Vector Store" 節點。</li>
                                </ol>
                                <figure>
                                    <a href="9/image.png" target="_blank"><img src="9/image.png" alt="刪除 Supabase 節點" class="img-fluid"></a>
                                    <figcaption class="text-muted mt-2">圖 1: 從聊天工作流中移除 Supabase 節點。</figcaption>
                                </figure>
                                <figure>
                                    <a href="9/image 1.png" target="_blank"><img src="9/image 1.png" alt="新增 Qdrant 節點" class="img-fluid"></a>
                                    <figcaption class="text-muted mt-2">圖 2: 加入 Qdrant Vector Store 作為新的檢索工具。</figcaption>
                                </figure>
                            </div>

                            <div class="step">
                                <h3 id="qdrant-settings"><i class="fas fa-cogs step-icon"></i>步驟二：設定 Qdrant 檢索節點</h3>
                                <p>接下來，我們需要詳細設定這個新的 Qdrant 節點，告訴它如何從我們的本地資料庫中查找相關資訊。</p>
                                <ol>
                                    <li>點擊開啟 "Qdrant Vector Store" 節點。</li>
                                    <li><strong>Credential:</strong> 選擇您在上一章建立的 Qdrant Credential。</li>
                                    <li><strong>Operation:</strong> 確認操作為 "Search for documents"。</li>
                                    <li><strong>Collection Name:</strong> 輸入我們使用的 Collection 名稱 <code>nhi_text-embedding-004_768</code>。</li>
                                    <li><strong>Limit:</strong> 保持預設值即可，這代表每次檢索回傳的資料筆數。</li>
                                </ol>
                                <figure>
                                    <a href="9/image 2.png" target="_blank"><img src="9/image 2.png" alt="設定 Qdrant 節點" class="img-fluid" style="max-width: 450px;"></a>
                                    <figcaption class="text-muted mt-2">圖 3: 仔細設定 Qdrant 節點的各項參數。</figcaption>
                                </figure>
                            </div>

                            <div class="step">
                                <h3><i class="fas fa-link step-icon"></i>步驟三：重新連接工作流</h3>
                                <p>設定完成後，需要將 Qdrant 節點正確地整合到現有的工作流中。</p>
                                <ol>
                                    <li>關閉節點設定視窗。</li>
                                    <li>將 "Qdrant Vector Store" 節點左下角的 "Tool" 接口，連接到 "Google Gemini Chat Model" 節點的圓球上。這一步是告訴 AI 模型，Qdrant 是它可以使用的外部工具之一。</li>
                                </ol>
                                <figure>
                                    <a href="9/image 3.png" target="_blank"><img src="9/image 3.png" alt="連接節點" class="img-fluid"></a>
                                    <figcaption class="text-muted mt-2">圖 4: 將 Qdrant 節點作為工具連接到 Gemini 模型。</figcaption>
                                </figure>
                            </div>

                            <div class="step">
                                <h3><i class="fas fa-comments step-icon"></i>步驟四：啟動聊天並驗證成果</h3>
                                <p>萬事俱備！現在讓我們來實際測試一下，看看 AI 是否能正確地從我們的本地知識庫中找到答案。</p>
                                <ol>
                                    <li>點擊 "When chat message received" 節點來啟動聊天測試介面。</li>
                                    <li>在聊天視窗中，輸入一個與您上傳的 PDF 文件相關的問題。例如：「補充保費的費率是多少？」</li>
                                    <li>觀察 AI 的回覆。如果一切設定正確，它應該會根據文件內容給出精確的答案。</li>
                                </ol>
                                <figure>
                                    <a href="9/image 4.png" target="_blank"><img src="9/image 4.png" alt="啟動聊天測試" class="img-fluid" style="max-width: 600px;"></a>
                                    <figcaption class="text-muted mt-2">圖 5: 透過聊天介面進行提問。</figcaption>
                                </figure>
                                <figure>
                                    <a href="9/image 5.png" target="_blank"><img src="9/image 5.png" alt="驗證 AI 回覆" class="img-fluid" style="max-width: 600px;"></a>
                                    <figcaption class="text-muted mt-2">圖 6: AI 成功地根據本地文件內容提供了正確答案。</figcaption>
                                </figure>
                            </div>
                        </section>
                    </div>

                    <div class="tutorial-summary">
                        <h4>本章總結與系列回顧</h4>
                        <p>太棒了！您已經成功完成了整個系列教學。您不僅建立了一個功能完整的 RAG 應用，更重要的是，您實現了它的完全私有化與在地化。讓我們回顧一下這趟旅程：</p>
                        <ul>
                            <li>從零開始，在本地建置了 <strong>n8n</strong> 的運行環境。</li>
                            <li>學會申請 <strong>Google Gemini API</strong>，並將其強大的語言模型整合至工作流中。</li>
                            <li>掌握了兩種向量資料庫的操作：雲端的 <strong>Supabase</strong> 與在地化的 <strong>Qdrant</strong>。</li>
                            <li>建立了自動化的工作流，能將文件（如 PDF）處理、向量化並存入資料庫。</li>
                            <li>最終，打造了一個能與您的私有知識庫互動的 <strong>AI 聊天機器人</strong>。</li>
                        </ul>
                        <p>您現在擁有的不僅是一套工具，更是一套解決問題的方法論。希望這個系列能為您的 AI 自動化之旅提供一個堅實的起點。未來還有無限可能，期待您創造出更多精彩的應用！</p>
                    </div>
                </article>

                <div class="mt-5 text-center">
                    <a href="../n8n-tutorials.html" class="btn btn-primary btn-lg"><i class="fas fa-arrow-left me-2"></i>返回 n8n 教學列表</a>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-light mt-5 py-3">
        <div class="container text-center">
            <p>&copy; 2025 侯俊嘉(Luke Hou). All rights reserved.</p>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../js/main.js"></script>
</body>
</html>